<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Resin Curing Time Calculator</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
    .card { max-width: 900px; margin: 28px auto; }
  </style>
</head>
<body class="bg-gray-100 min-h-screen py-8">
  <main class="card p-6 bg-white rounded-2xl shadow-lg mx-4">
    <h1 class="text-2xl font-bold mb-3">Resin Curing Time Calculator</h1>
    <p class="text-sm mb-4">Choose resin type, enter approximate maximum dimension (mm) and select your curing station. Click <span class="font-semibold">Enter</span> to get an estimated optimal curing time (format <code>hh:mm:ss</code>).</p>

    <form id="calcForm" class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
      <div>
        <label for="resinSelect" class="block text-sm font-medium mb-1">Resin type</label>
        <select id="resinSelect" class="mt-1 block w-full rounded p-2 border"></select>
        <p id="resinDesc" class="text-xs text-gray-600 mt-1"></p>
      </div>

      <div>
        <label for="stationSelect" class="block text-sm font-medium mb-1">Curing station</label>
        <select id="stationSelect" class="mt-1 block w-full rounded p-2 border"></select>
        <p id="stationDesc" class="text-xs text-gray-600 mt-1"></p>
      </div>

      <div>
        <label for="maxDim" class="block text-sm font-medium mb-1">Approx. max dimension (mm)</label>
        <input id="maxDim" type="number" min="0" step="1" value="50" class="mt-1 block w-full rounded p-2 border" />
        <p class="text-xs text-gray-600 mt-1">Examples: 28 (miniature head), 120 (large bust), 200 (full prop).</p>
      </div>
    </form>

    <div class="flex gap-2">
      <button id="enterBtn" class="px-4 py-2 rounded bg-blue-600 text-white">Enter</button>
      <button id="resetBtn" class="px-4 py-2 rounded border">Reset</button>
      <button id="saveBtn" class="px-4 py-2 rounded border">Save settings</button>
    </div>

    <div id="resultBox" class="hidden mt-6 p-4 rounded border bg-gray-50">
      <h2 class="font-semibold">Estimated optimal curing time</h2>
      <p id="resultTime" class="text-lg mt-2 font-mono"></p>
      <p id="resultDetails" class="text-sm text-gray-700 mt-2"></p>

      <div class="mt-3 text-xs text-gray-600">
        <strong>Important:</strong> These are conservative, algorithmic estimates. Real optimal cure times depend on resin formulation, part geometry (thin walls vs solid), LED wavelength and power, and manufacturer recommendations. Always check the resin manufacturer's data sheet for precise settings and perform a test cure on a sacrificial print before a production run.
      </div>
    </div>

    <div class="mt-6 text-sm text-gray-600">
      <p class="font-semibold">Notes & sources</p>
      <ul class="list-disc pl-5 mt-2">
        <li>Resin type categories and material guidance are based on standard classifications used by major resin manufacturers.</li>
        <li>Curing equipment examples include Formlabs Form Cure, Anycubic Wash & Cure, Elegoo Mercury series, Phrozen Cure station and consumer cure boxes — performance varies.</li>
        <li>This calculator uses simplified heuristics to produce fast, easy-to-read guidance — treat outputs as starting points, not absolute factory settings.</li>
      </ul>
    </div>
  </main>

  <script>
    const resins = [
      { id: 'standard', name: 'Standard (general purpose)', baseSeconds: 300, desc: 'Good for general miniatures and models.' },
      { id: 'tough', name: 'Tough / ABS-like', baseSeconds: 420, desc: 'Higher strength, needs slightly longer cure.' },
      { id: 'durable', name: 'Durable / Impact resistant', baseSeconds: 480, desc: 'Engineered for toughness.' },
      { id: 'flexible', name: 'Flexible / Rubber-like (TPU)', baseSeconds: 600, desc: 'Elastomeric resins need more curing.' },
      { id: 'high_temp', name: 'High-temp / Heat resistant', baseSeconds: 900, desc: 'Heat-resistant resins generally need long cures.' },
      { id: 'castable', name: 'Castable (investment casting)', baseSeconds: 600, desc: 'Used for jewelry/casting; watch manufacturer guidelines.' },
      { id: 'dental', name: 'Dental / Biocompatible', baseSeconds: 1200, desc: 'Medical/dental resins often have manufacturer-specific settings.' },
      { id: 'clear', name: 'Clear / Transparent', baseSeconds: 360, desc: 'Clear resins often need careful postprocess.' },
      { id: 'water_wash', name: 'Water-wash resin', baseSeconds: 300, desc: 'Formulations that wash with water.' },
      { id: 'plant', name: 'Plant-based / bio resin', baseSeconds: 300, desc: 'Eco-focused resins similar to standard.' },
      { id: 'ceramic', name: 'Ceramic / Fillers', baseSeconds: 600, desc: 'Filled resins often need longer cures for full hardness.' },
      { id: 'clear_tough', name: 'Clear Tough', baseSeconds: 480, desc: 'Clear + tough hybrids.' }
    ];

    const stations = [
      { id: 'formlabs_formcure', name: 'Formlabs Form Cure (Pro)', multiplier: 0.85, desc: 'High-power, temperature-controlled post-cure system.' },
      { id: 'formlabs_formcure_l', name: 'Form Cure L / Form Cure (large)', multiplier: 0.85, desc: 'Large-format Form Cure.' },
      { id: 'anycubic_wash_cure', name: 'Anycubic Wash & Cure (typical consumer)', multiplier: 1.0, desc: 'Common consumer 360° curing station.' },
      { id: 'elegoo_mercury', name: 'Elegoo Mercury Series (typical consumer)', multiplier: 1.0, desc: 'Popular wash+cure units with 405nm LEDs.' },
      { id: 'phrozen_cure', name: 'Phrozen Cure Station', multiplier: 0.95, desc: 'Higher output consumer/studio station.' },
      { id: 'creality_uw01', name: 'Creality UW-01 / Cure box', multiplier: 1.05, desc: 'Lower-power small cure box.' },
      { id: 'sunlight', name: 'Direct Sunlight (outdoor)', multiplier: 4.0, desc: 'Highly variable; usually far slower than dedicated cure boxes.' },
      { id: 'uv_box_low', name: 'DIY / Low-power UV box', multiplier: 1.4, desc: 'Non-optimized or low-power LED arrays.' },
      { id: 'peopoly_cure', name: 'Peopoly Cure Station', multiplier: 0.95, desc: 'Studio-grade consumer option.' }
    ];

    function sizeFactorFromMaxDim(mm) {
      if (!mm || mm <= 0) return 1.0;
      if (mm <= 50) return 1.0;
      if (mm <= 150) return 1.6;
      return 2.5;
    }

    function formatHHMMSS(seconds) {
      seconds = Math.max(0, Math.round(seconds));
      const h = Math.floor(seconds / 3600);
      const m = Math.floor((seconds % 3600) / 60);
      const s = seconds % 60;
      const z = (n) => String(n).padStart(2, '0');
      return `${z(h)}:${z(m)}:${z(s)}`;
    }

    document.addEventListener('DOMContentLoaded', () => {
      const resinSelect = document.getElementById('resinSelect');
      const stationSelect = document.getElementById('stationSelect');
      const resinDesc = document.getElementById('resinDesc');
      const stationDesc = document.getElementById('stationDesc');
      const maxDimInput = document.getElementById('maxDim');
      const enterBtn = document.getElementById('enterBtn');
      const resetBtn = document.getElementById('resetBtn');
      const saveBtn = document.getElementById('saveBtn');
      const resultBox = document.getElementById('resultBox');
      const resultTime = document.getElementById('resultTime');
      const resultDetails = document.getElementById('resultDetails');

      resins.forEach(r => {
        const opt = document.createElement('option');
        opt.value = r.id;
        opt.textContent = r.name;
        resinSelect.appendChild(opt);
      });
      stations.forEach(s => {
        const opt = document.createElement('option');
        opt.value = s.id;
        opt.textContent = s.name;
        stationSelect.appendChild(opt);
      });

      function loadSaved() {
        try {
          const saved = JSON.parse(localStorage.getItem('resinCure.lastSettings') || '{}');
          if (saved.resin) resinSelect.value = saved.resin;
          if (saved.station) stationSelect.value = saved.station;
          if (saved.maxDim) maxDimInput.value = saved.maxDim;
        } catch {}
        updateDescriptions();
      }

      function saveSettings() {
        const payload = { resin: resinSelect.value, station: stationSelect.value, maxDim: maxDimInput.value };
        try {
          localStorage.setItem('resinCure.lastSettings', JSON.stringify(payload));
          alert('Settings saved locally.');
        } catch {}
      }

      function updateDescriptions() {
        const r = resins.find(x => x.id === resinSelect.value) || resins[0];
        const s = stations.find(x => x.id === stationSelect.value) || stations[2];
        resinDesc.textContent = 'Resin description: ' + r.desc;
        stationDesc.textContent = 'Station note: ' + s.desc;
      }

      function calculateAndShow() {
        const r = resins.find(x => x.id === resinSelect.value) || resins[0];
        const s = stations.find(x => x.id === stationSelect.value) || stations[2];
        const dim = parseFloat(maxDimInput.value) || 0;
        const sizeFactor = sizeFactorFromMaxDim(dim);
        const rawSeconds = r.baseSeconds * s.multiplier * sizeFactor;
        const withMargin = rawSeconds * 1.10;
        const seconds = Math.max(30, Math.round(withMargin));

        resultTime.textContent = formatHHMMSS(seconds);
        resultDetails.textContent = `Computation details: base ${r.name} raw base seconds ${r.baseSeconds}s × station multiplier ${s.multiplier} × size factor ${sizeFactor} × margin 1.10 = ${seconds}s`;
        resultBox.classList.remove('hidden');
      }

      resinSelect.addEventListener('change', updateDescriptions);
      stationSelect.addEventListener('change', updateDescriptions);
      enterBtn.addEventListener('click', e => { e.preventDefault(); calculateAndShow(); });
      resetBtn.addEventListener('click', e => { e.preventDefault(); resinSelect.value = resins[0].id; stationSelect.value = stations[2].id; maxDimInput.value = '50'; resultBox.classList.add('hidden'); updateDescriptions(); });
      saveBtn.addEventListener('click', e => { e.preventDefault(); saveSettings(); });

      maxDimInput.addEventListener('keydown', ev => { if (ev.key === 'Enter') { ev.preventDefault(); calculateAndShow(); } });

      loadSaved();
    });
  </script>
</body>
</html>
